<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="/assets/images/character.webp"/><link rel="preload" as="image" href="/assets/images/icons/back.svg"/><link rel="preload" as="image" href="/assets/images/icons/left-arrow.svg"/><link rel="stylesheet" href="/_next/static/css/c04317aca650950e.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/cdb8f50a3d0f47d7.css" data-precedence="next"/><link rel="preload" href="/_next/static/chunks/webpack-71139cd19b4b072b.js" as="script" fetchPriority="low"/><script src="/_next/static/chunks/fd9d1056-ef33cd78b8d8878c.js" async=""></script><script src="/_next/static/chunks/596-6a9d4376673ce765.js" async=""></script><script src="/_next/static/chunks/main-app-c4963ddc41ab0a86.js" async=""></script><link rel="preload" as="script" href="https://www.googletagmanager.com/gtag/js?id=undefined"/><title>라니.로그 | 다국어 적용시 라우팅 관련 트러블슈팅</title><meta name="description" content="i18n 작업 중 언어 변경시에 캐시로 인한 라우팅 오작동 문제 해결하기"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="200x200"/><script src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><body class="__className_f8d089 px-[20px]"><div id="main-root" class="mx-[-20px]"><header class="container-layout border-style flex justify-center border-y bg-zinc-800"><div class="content-layout border-style flex items-center justify-between border-x"><p class="border-style border-r bg-neutral-900 px-4 py-3 text-xl font-bold text-app-white transition-colors ease-in md:text-2xl"><a href="/"><span class="__className_c1a29b">&lt;Welcome! /&gt;</span></a></p><div class="border-style flex h-full items-center border-l md:hidden"><button type="button" class="relative h-[36px] w-[36px] before:absolute before:top-[-50%] before:block before:border-[18px] before:border-transparent before:border-b-neutral-900   after:absolute after:top-[50%] after:block after:border-[18px] after:border-transparent after:border-t-neutral-900   "><span class="hidden-text">메뉴 열기</span></button></div><ul class="hidden h-full md:flex"><li class="border-style flex h-full items-center border-l"><a class="bg-neutral-900 border-style flex h-full items-center rounded-full border-x px-8 text-base text-app-white transition-colors ease-in" href="/posts">Posts</a></li><li class="border-style flex h-full items-center border-l"><a class="false border-style flex h-full items-center rounded-full border-x px-8 text-base text-app-white transition-colors ease-in" href="/series">Series</a></li></ul></div></header><main class="flex min-h-screen flex-col"><section class="container-layout border-style grow-0 border-b bg-zinc-800"><div class="content-layout border-style relative justify-center border-x text-center text-app-white"><div class="flex flex-col justify-center px-4 py-16 md:px-5 md:py-20"><p class="mb-3 text-sm">트러블슈팅<!-- --> </p><h1 class="text-xl md:text-4xl">다국어 적용시 라우팅 관련 트러블슈팅</h1></div></div></section><section class="container-layout border-style grow-0 border-b bg-zinc-800"><div class="content-layout"><div class="border-style align-center flex justify-center border-x text-app-white md:justify-start md:text-center"><p class="border-style border-l p-5 text-sm md:border-l-0">2023-09-07</p><p class="border-style flex items-center justify-center gap-1 border-x p-5 text-sm"><img alt="" loading="lazy" width="21" height="21" decoding="async" data-nimg="1" style="color:transparent" src="/assets/images/icons/timer.svg"/>약 <!-- -->5<!-- -->분</p></div></div></section><section class="container-layout bg-zinc-800"><div class="content-layout border-style flex flex-col border-x"><div class="flex"><div class="border-style relative hidden w-[280px] shrink-0 border-r bg-zinc-800 lg:block"><div class="sticky top-0 bg-zinc-800"><div class="border-style px-4"><div class="border-style mx-[-1rem] flex items-center border-b p-4"><div class="relative h-[40px] w-[40px] rounded-full border border-transparent bg-white"><img src="/assets/images/character.webp" alt="lani"/></div><p class="ml-4 text-app-white">developer Lani</p></div><div class="border-style mx-[-1rem] border-b p-4"><button type="button" class="flex items-center gap-2 text-sm font-bold text-app-pink"><img src="/assets/images/icons/back.svg" alt="back" class="b-[15px] h-[15px]"/><p>go to back</p></button></div><div class="mx-[-1rem] p-4 text-sm"><p class="font-bold text-app-white">table of contents</p><ul class="mt-2 flex max-h-[400px] flex-col gap-2 overflow-y-auto overflow-x-hidden text-neutral-500"><li><a href="/posts/i18n_language_selector_trouble#언어-변경시-쿠키와-라우팅-경로가-불일치하는-현상-해결하기">언어 변경시 쿠키와 라우팅 경로가 불일치하는 현상 해결하기</a><ul class="mt-2 flex flex-col gap-2 pl-4"><li><a href="/posts/i18n_language_selector_trouble#현재-미들웨어-구현-사항">현재 미들웨어 구현 사항</a></li><li><a href="/posts/i18n_language_selector_trouble#테스트-시나리오">테스트 시나리오</a></li><li><a href="/posts/i18n_language_selector_trouble#원인-파악">원인 파악</a></li><li><a href="/posts/i18n_language_selector_trouble#해결-방안">해결 방안</a></li><li><a href="/posts/i18n_language_selector_trouble#결론">결론</a></li></ul></li></ul></div><div class="border-style mx-[-1rem] border-t p-4 text-sm"><p class="font-bold text-app-white">tags</p><ul class="mt-2 flex flex-wrap gap-2"><li class="text-neutral-400">i18n</li><li class="text-neutral-400">trouble shotting</li></ul></div></div></div></div><div class="flex w-full flex-col bg-neutral-800 lg:w-[742px]"><div class="markdown-viewer box-border w-full bg-neutral-800 p-4 text-app-white md:p-5"><h2 id="언어-변경시-쿠키와-라우팅-경로가-불일치하는-현상-해결하기"><a aria-hidden="true" tabindex="-1" href="#언어-변경시-쿠키와-라우팅-경로가-불일치하는-현상-해결하기"><span class="icon icon-link"></span></a>언어 변경시 쿠키와 라우팅 경로가 불일치하는 현상 해결하기</h2>
<h3 id="현재-미들웨어-구현-사항"><a aria-hidden="true" tabindex="-1" href="#현재-미들웨어-구현-사항"><span class="icon icon-link"></span></a>현재 미들웨어 구현 사항</h3>
<div data-remark-code-title="true" data-language="ts">middleware.ts</div>
<pre><span class="language-text">ts</span><pre style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto;border-radius:0"><code class="language-ts" style="background:hsl(220, 13%, 18%);color:hsl(220, 14%, 71%);text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:&quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">1</span><span class="token module" style="color:hsl(286, 60%, 67%)">import</span><span> </span><span class="token imports" style="color:hsl(220, 14%, 71%)">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">NextRequest</span><span class="token imports" style="color:hsl(220, 14%, 71%)">,</span><span class="token imports"> </span><span class="token imports maybe-class-name">NextResponse</span><span class="token imports"> </span><span class="token imports" style="color:hsl(220, 14%, 71%)">}</span><span> </span><span class="token module" style="color:hsl(286, 60%, 67%)">from</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;next/server&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">2</span><span></span><span class="token module" style="color:hsl(286, 60%, 67%)">import</span><span> </span><span class="token imports">acceptLanguage</span><span> </span><span class="token module" style="color:hsl(286, 60%, 67%)">from</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;accept-language&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">3</span><span></span><span class="token module" style="color:hsl(286, 60%, 67%)">import</span><span> </span><span class="token imports" style="color:hsl(220, 14%, 71%)">{</span><span class="token imports"> fallbackLng</span><span class="token imports" style="color:hsl(220, 14%, 71%)">,</span><span class="token imports"> languages </span><span class="token imports" style="color:hsl(220, 14%, 71%)">}</span><span> </span><span class="token module" style="color:hsl(286, 60%, 67%)">from</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;./i18n/settings&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">4</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">5</span><span>acceptLanguage</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token method property-access" style="color:hsl(207, 82%, 66%)">languages</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>languages</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">6</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">7</span><span></span><span class="token module" style="color:hsl(286, 60%, 67%)">export</span><span> </span><span class="token" style="color:hsl(286, 60%, 67%)">const</span><span> config </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">8</span><span>  matcher</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">[</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">9</span><span>    </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;/((?!api|_next/static|_next/image|images|fonts|videos|assets|favicon.ico|robots|sitemap|sw.js).*)&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">10</span><span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">]</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">11</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span class="token" style="color:hsl(220, 14%, 71%)">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">12</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">13</span><span></span><span class="token" style="color:hsl(286, 60%, 67%)">const</span><span> cookieName </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;i18next&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">14</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">15</span><span></span><span class="token" style="color:hsl(286, 60%, 67%)">const</span><span> getLanguageFromRequest </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>req</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> </span><span class="token maybe-class-name">NextRequest</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> </span><span class="token" style="color:hsl(95, 38%, 62%)">string</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">|</span><span> </span><span class="token nil" style="color:hsl(286, 60%, 67%)">null</span><span> </span><span class="token arrow" style="color:hsl(207, 82%, 66%)">=&gt;</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">16</span><span>  </span><span class="token" style="color:hsl(286, 60%, 67%)">const</span><span> language </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> req</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token property-access">cookies</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token method property-access" style="color:hsl(207, 82%, 66%)">has</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>cookieName</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">17</span><span>    </span><span class="token" style="color:hsl(207, 82%, 66%)">?</span><span> req</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token property-access">cookies</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token method property-access" style="color:hsl(207, 82%, 66%)">get</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>cookieName</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(207, 82%, 66%)">?.</span><span>value </span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">// 1</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">18</span><span>    </span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> req</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token property-access">headers</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token method property-access" style="color:hsl(207, 82%, 66%)">get</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;Accept-Language&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">;</span><span> </span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">// 2</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">19</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">20</span><span>  </span><span class="token control-flow" style="color:hsl(286, 60%, 67%)">return</span><span> acceptLanguage</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token method property-access" style="color:hsl(207, 82%, 66%)">get</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>language</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">||</span><span> </span><span class="token nil" style="color:hsl(286, 60%, 67%)">null</span><span class="token" style="color:hsl(220, 14%, 71%)">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">21</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span class="token" style="color:hsl(220, 14%, 71%)">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">22</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">23</span><span></span><span class="token module" style="color:hsl(286, 60%, 67%)">export</span><span> </span><span class="token" style="color:hsl(286, 60%, 67%)">function</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">middleware</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>req</span><span class="token" style="color:hsl(207, 82%, 66%)">:</span><span> </span><span class="token maybe-class-name">NextRequest</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">24</span><span>  </span><span class="token" style="color:hsl(286, 60%, 67%)">const</span><span> language </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">getLanguageFromRequest</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>req</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">||</span><span> fallbackLng</span><span class="token" style="color:hsl(220, 14%, 71%)">;</span><span> </span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">// 3</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">25</span><span>  </span><span class="token" style="color:hsl(286, 60%, 67%)">const</span><span> response </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> </span><span class="token maybe-class-name">NextResponse</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token method property-access" style="color:hsl(207, 82%, 66%)">next</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">26</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">27</span><span>  response</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token property-access">cookies</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token method property-access" style="color:hsl(207, 82%, 66%)">set</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>cookieName</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> language</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">;</span><span> </span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">// 4</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">28</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">29</span><span>  </span><span class="token" style="color:hsl(286, 60%, 67%)">const</span><span> languageInNextUrl </span><span class="token" style="color:hsl(207, 82%, 66%)">=</span><span> languages</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token method property-access" style="color:hsl(207, 82%, 66%)">find</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>loc</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token arrow" style="color:hsl(207, 82%, 66%)">=&gt;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">30</span><span>    req</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token property-access">nextUrl</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token property-access">pathname</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token method property-access" style="color:hsl(207, 82%, 66%)">startsWith</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token template-string template-punctuation" style="color:hsl(95, 38%, 62%)">`</span><span class="token template-string" style="color:hsl(95, 38%, 62%)">/</span><span class="token template-string interpolation" style="color:hsl(220, 14%, 71%)">${</span><span class="token template-string interpolation">loc</span><span class="token template-string interpolation" style="color:hsl(220, 14%, 71%)">}</span><span class="token template-string template-punctuation" style="color:hsl(95, 38%, 62%)">`</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">31</span><span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">32</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">33</span><span>  </span><span class="token control-flow" style="color:hsl(286, 60%, 67%)">if</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>languageInNextUrl </span><span class="token" style="color:hsl(207, 82%, 66%)">&amp;&amp;</span><span> language </span><span class="token" style="color:hsl(207, 82%, 66%)">!==</span><span> languageInNextUrl</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">34</span><span>    response</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token property-access">cookies</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token method property-access" style="color:hsl(207, 82%, 66%)">set</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>cookieName</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> languageInNextUrl</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">35</span><span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">36</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">37</span><span>  </span><span class="token" style="color:hsl(220, 10%, 40%);font-style:italic">// 5</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">38</span><span>  </span><span class="token control-flow" style="color:hsl(286, 60%, 67%)">if</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">39</span><span>    </span><span class="token" style="color:hsl(207, 82%, 66%)">!</span><span>languages</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token method property-access" style="color:hsl(207, 82%, 66%)">some</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>loc</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token arrow" style="color:hsl(207, 82%, 66%)">=&gt;</span><span> req</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token property-access">nextUrl</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token property-access">pathname</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token method property-access" style="color:hsl(207, 82%, 66%)">startsWith</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token template-string template-punctuation" style="color:hsl(95, 38%, 62%)">`</span><span class="token template-string" style="color:hsl(95, 38%, 62%)">/</span><span class="token template-string interpolation" style="color:hsl(220, 14%, 71%)">${</span><span class="token template-string interpolation">loc</span><span class="token template-string interpolation" style="color:hsl(220, 14%, 71%)">}</span><span class="token template-string template-punctuation" style="color:hsl(95, 38%, 62%)">`</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(207, 82%, 66%)">&amp;&amp;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">40</span><span>    </span><span class="token" style="color:hsl(207, 82%, 66%)">!</span><span>req</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token property-access">nextUrl</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token property-access">pathname</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token method property-access" style="color:hsl(207, 82%, 66%)">startsWith</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token" style="color:hsl(95, 38%, 62%)">&#x27;/_next&#x27;</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">41</span><span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span> </span><span class="token" style="color:hsl(220, 14%, 71%)">{</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">42</span><span>    </span><span class="token control-flow" style="color:hsl(286, 60%, 67%)">return</span><span> </span><span class="token maybe-class-name">NextResponse</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token method property-access" style="color:hsl(207, 82%, 66%)">redirect</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">43</span><span>      </span><span class="token" style="color:hsl(286, 60%, 67%)">new</span><span> </span><span class="token" style="color:hsl(29, 54%, 61%)">URL</span><span class="token" style="color:hsl(220, 14%, 71%)">(</span><span class="token template-string template-punctuation" style="color:hsl(95, 38%, 62%)">`</span><span class="token template-string" style="color:hsl(95, 38%, 62%)">/</span><span class="token template-string interpolation" style="color:hsl(220, 14%, 71%)">${</span><span class="token template-string interpolation">language</span><span class="token template-string interpolation" style="color:hsl(220, 14%, 71%)">}</span><span class="token template-string interpolation" style="color:hsl(220, 14%, 71%)">${</span><span class="token template-string interpolation">req</span><span class="token template-string interpolation" style="color:hsl(220, 14%, 71%)">.</span><span class="token template-string interpolation property-access">nextUrl</span><span class="token template-string interpolation" style="color:hsl(220, 14%, 71%)">.</span><span class="token template-string interpolation property-access">pathname</span><span class="token template-string interpolation" style="color:hsl(220, 14%, 71%)">}</span><span class="token template-string template-punctuation" style="color:hsl(95, 38%, 62%)">`</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span> req</span><span class="token" style="color:hsl(220, 14%, 71%)">.</span><span class="token property-access">url</span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">,</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">44</span><span>    </span><span class="token" style="color:hsl(220, 14%, 71%)">)</span><span class="token" style="color:hsl(220, 14%, 71%)">;</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">45</span><span>  </span><span class="token" style="color:hsl(220, 14%, 71%)">}</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:hsl(220, 10%, 40%);font-style:italic">46</span><span></span><span class="token" style="color:hsl(220, 14%, 71%)">}</span></code></pre></pre>
<ol>
<li>&#x27;/&#x27; 로 접근시 특정 쿠키 값이 존재하면 해당 값에 해당하는 라우팅 세그먼트로 변경</li>
<li>쿠키가 없다면 req.header accept-language로 설정된 값이 개발자가 설정한 언어 리스트에서 존재한다면 라우팅 세그먼트로 변경</li>
<li>모두 해당하지 않는다면 개발자가 설정한 fallback 언어로 라우팅 세그먼트로 변경</li>
<li>위 세가지에 절차를 마친 language 값을 쿠키에 저장</li>
<li>/{언어}가 아닌 다른 세그먼트 값으로 접근시 language 값을 첫번째 세그먼트에 세팅</li>
</ol>
<p>위와 같은 middleware 설정시 개발자는 a 태그 또는 Link(next) 태그 그리고 router 사용시 pathname을 일관성있게 작업할 수 있게 된다.</p>
<h3 id="테스트-시나리오"><a aria-hidden="true" tabindex="-1" href="#테스트-시나리오"><span class="icon icon-link"></span></a>테스트 시나리오</h3>
<ol>
<li>&#x27;/&#x27; 경로로 접근 &gt; fallback 언어 redirect 정상 작동 <code>(예: &#x27;/&#x27; -&gt; &#x27;/en&#x27;)</code></li>
<li>루트 경로(&#x27;/en&#x27;) &gt; 언어변경 정상 작동 <code>(예: &#x27;/en&#x27; -&gt; &#x27;/th&#x27;)</code></li>
</ol>
<p><img src="data:image/i18n_language_selector_trouble;base64,dmVyc2lvbiBodHRwczovL2dpdC1sZnMuZ2l0aHViLmNvbS9zcGVjL3YxCm9pZCBzaGEyNTY6NmVjMzMyMWU0MDQ3NGFmNWVlNzhlMWY4YzRmNDExMmZhN2I0MGQzMzZhMmVmNWQ2MWQyZjU5YWQyZjhiMTQwOApzaXplIDE1NzM5NzAwCg==" alt="i18n_language_selector_trouble" class="max-w-full"/></p>
<ol start="3">
<li>루트 경로 &gt; about 페이지 이동 정상 작동 <code>(예: &#x27;/th&#x27; &gt; &#x27;/th/about&#x27;)</code></li>
<li>about 페이지 &gt; 언어 변경 &gt; 변경된 언어의 루트 이동 정상 작동 <code>(예: /{변경 언어})</code></li>
</ol>
<p><img src="data:image/i18n_language_selector_trouble_2;base64,dmVyc2lvbiBodHRwczovL2dpdC1sZnMuZ2l0aHViLmNvbS9zcGVjL3YxCm9pZCBzaGEyNTY6YmUyODQ0MWQ0YmE2MDgwMDU2NjZlMmRjZWE2YWNmMzg0ZDZhMzQwYTc4ZmNiZmVjZmVlNzYzZDE5N2M0MWY5YgpzaXplIDE3MDk5Mzk3Cg==" alt="i18n_language_selector_trouble_2" class="max-w-full"/></p>
<ol start="5">
<li>루트 &gt; about 페이지 이동 <em><strong>쿠키는 정상 작동, routing 오작동</strong></em></li>
</ol>
<p><img src="data:image/i18n_language_selector_trouble_3;base64,dmVyc2lvbiBodHRwczovL2dpdC1sZnMuZ2l0aHViLmNvbS9zcGVjL3YxCm9pZCBzaGEyNTY6MTE1MThjODM1MzkzMDgyZmVhMjQyZDUzMjRjZWM2MDgwODMyNTc5MDk5NzZiYzQwZmQzZTBmOWM1ZDI0YmUzOQpzaXplIDExNzg4MzE0Cg==" alt="i18n_language_selector_trouble_3" class="max-w-full"/></p>
<h3 id="원인-파악"><a aria-hidden="true" tabindex="-1" href="#원인-파악"><span class="icon icon-link"></span></a>원인 파악</h3>
<p>원인은 다름 아닌 NextJS 캐싱이 원인이였다.</p>
<p>현재 동작에서는 언어 설정 변경시 next/navigation의 <code>router.push</code>를 통해 라우팅을 변경해줬다.</p>
<p>next의 앱 라우터는 라우팅 탐색에 대해 하이브리드 접근 방식을 사용하고 있다.</p>
<ul>
<li>서버 - 라우트 세그먼트별로 자동으로 애플리케이션 코드가 분할된다.</li>
<li>클라이언트 - Next.js는 라우트 세그먼트를 미리 가져오고 캐시한다.</li>
</ul>
<p>이렇게 하는 이유는 사용자가 새 경로로 이동할 때 브라우저가 페이지를 다시 로드하지 않고 변경된 경로 세그먼트만 다시 렌더링하여 사용자 경험과 성능을 개선하기 위해서라고 한다.
<a href="https://nextjs.org/docs/app/building-your-application/routing/linking-and-navigating#how-routing-and-navigation-works">참고</a></p>
<h3 id="해결-방안"><a aria-hidden="true" tabindex="-1" href="#해결-방안"><span class="icon icon-link"></span></a>해결 방안</h3>
<p>언어 변경시 루트 경로로 라우팅 처리를 해주고 있다.</p>
<p>현재 라우팅 세그먼트를 유지할 필요가 없다면, <code>window.location.href</code>를 변경해서 브라우저 주소 값을 변경해서 페이지를 처음부터 다시 로드해도 될 것 같다.</p>
<p>개발자도구 &gt; 네트워크 탭을 통해 원인이 맞는지 확인해보자.</p>
<ul>
<li><code>router.push</code>를 통해 라우팅 했을 때</li>
</ul>
<p><img src="data:image/i18n_language_selector_trouble_4;base64,dmVyc2lvbiBodHRwczovL2dpdC1sZnMuZ2l0aHViLmNvbS9zcGVjL3YxCm9pZCBzaGEyNTY6OTRlZmQ5NjQ0Zjg0M2U4YjY4NzgxZDJkMzk1Yzc4ODBlMDQ0ZDc2ZDkxY2UzOGI1ZmYxN2FjZjkwNzVhYzIyMQpzaXplIDUwMjEwNjgwCg==" alt="i18n_language_selector_trouble_4" class="max-w-full"/></p>
<ul>
<li><code>window.location.href</code>를 통해 라우팅 했을 때</li>
</ul>
<p><img src="data:image/i18n_language_selector_trouble_5;base64,dmVyc2lvbiBodHRwczovL2dpdC1sZnMuZ2l0aHViLmNvbS9zcGVjL3YxCm9pZCBzaGEyNTY6NmM1NGYyZDMyOThiNTQ2ODllNTRlZGI0Y2MyNGIxMTc2MWFkYzY2ODhlNTI3NDExMzgxMmYwOGVlNWVhZGFlMgpzaXplIDU1MTkyMjAzCg==" alt="i18n_language_selector_trouble_5" class="max-w-full"/></p>
<h3 id="결론"><a aria-hidden="true" tabindex="-1" href="#결론"><span class="icon icon-link"></span></a>결론</h3>
<p>쿠키, routing 모두 동일하게 정상 작동한다.</p>
<p>하지만 <code>window.location.href</code>로 처리하는게 정답인지는 모르겠다.</p>
<p>만약 언어별 다른 도메인을 사용했다면 당연히 처리해야했지만 i18n 연동을 하여 동일한 도메인에 세그먼트만 동적으로 처리하다 보니 router.push로 당연히 될 줄 알았다.</p>
<p>언어 변경시에만 캐싱 처리를 회피하면서 next app router를 활용할 방안을 고민해야하는 숙제가 생겼다.</p></div><div class="border-style mt-auto flex flex-col border-t p-4 text-app-white"><p class="text-base text-app-blue-green"><span class="border-style inline-block border-x border-t bg-zinc-800 px-4 py-2">See more &quot;<!-- -->트러블슈팅<!-- -->&quot;</span></p><ul class="border-style border bg-zinc-800"><li class="border-style flex gap-4 border-b p-4 text-sm last-of-type:border-b-0"><p>1</p><a href="/posts/i18n_language_selector_trouble">다국어 적용시 라우팅 관련 트러블슈팅</a><p class="ml-auto">2023.09.07</p></li></ul></div><div class="flex-between border-style mt-auto flex border-t bg-zinc-800 text-app-white"><div class="border-style flex w-[50%] p-4"><a class="flex gap-4" href="/posts/remove_git_file_history"><span><img src="/assets/images/icons/left-arrow.svg" alt="prev" class="h-[18px] w-[18px]"/></span><div class="flex flex-col items-start gap-1"><p class="text-sm text-neutral-500">prev</p><p class="max-w-[120px] truncate text-neutral-300 md:max-w-[200px]">Github에 잘못 올린 파일 및 커밋 히스토리 삭제하기<!-- -->Github에 잘못 올린 파일 및 커밋 히스토리 삭제하기<!-- -->Github에 잘못 올린 파일 및 커밋 히스토리 삭제하기</p></div></a></div><div class="flex w-[50%] justify-end p-4"></div></div><div class="border-style border-t px-4 pt-4"></div></div></div></div></section></main><footer class="__className_bbf4d0 container-layout border-style border-y bg-neutral-800"><div class="content-layout border-style border-x py-4"><p class="text-center text-xs font-bold text-app-white md:text-sm">© 2023 Lani. All Rights Reserved.</p></div></footer></div><div id="modal-root"></div><script src="/_next/static/chunks/webpack-71139cd19b4b072b.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/c04317aca650950e.css\",{\"as\":\"style\"}]\n0:\"$L2\"\n"])</script><script>self.__next_f.push([1,"3:HL[\"/_next/static/css/cdb8f50a3d0f47d7.css\",{\"as\":\"style\"}]\n"])</script><script>self.__next_f.push([1,"4:I{\"id\":57948,\"chunks\":[\"272:static/chunks/webpack-71139cd19b4b072b.js\",\"971:static/chunks/fd9d1056-ef33cd78b8d8878c.js\",\"596:static/chunks/596-6a9d4376673ce765.js\"],\"name\":\"default\",\"async\":false}\n6:I{\"id\":56628,\"chunks\":[\"272:static/chunks/webpack-71139cd19b4b072b.js\",\"971:static/chunks/fd9d1056-ef33cd78b8d8878c.js\",\"596:static/chunks/596-6a9d4376673ce765.js\"],\"name\":\"\",\"async\":false}\n7:I{\"id\":83015,\"chunks\":[\"185:static/chunks/app/layout-1fc3107db266d2fc.js\"],\"name\":\"\",\"async\":false}\n8:I{\"id\":47767,\"chu"])</script><script>self.__next_f.push([1,"nks\":[\"272:static/chunks/webpack-71139cd19b4b072b.js\",\"971:static/chunks/fd9d1056-ef33cd78b8d8878c.js\",\"596:static/chunks/596-6a9d4376673ce765.js\"],\"name\":\"default\",\"async\":false}\n9:I{\"id\":57920,\"chunks\":[\"272:static/chunks/webpack-71139cd19b4b072b.js\",\"971:static/chunks/fd9d1056-ef33cd78b8d8878c.js\",\"596:static/chunks/596-6a9d4376673ce765.js\"],\"name\":\"default\",\"async\":false}\nb:I{\"id\":73630,\"chunks\":[\"685:static/chunks/685-4f0f72178562bcc6.js\",\"432:static/chunks/app/(blog)/layout-b96310e79ce06317.js\"],\"name"])</script><script>self.__next_f.push([1,"\":\"\",\"async\":false}\nc:I{\"id\":34663,\"chunks\":[\"685:static/chunks/685-4f0f72178562bcc6.js\",\"432:static/chunks/app/(blog)/layout-b96310e79ce06317.js\"],\"name\":\"\",\"async\":false}\n"])</script><script>self.__next_f.push([1,"2:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/c04317aca650950e.css\",\"precedence\":\"next\"}]],[\"$\",\"$L4\",null,{\"buildId\":\"7VfLtjj37LlRwhVpEjq7M\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/posts/i18n_language_selector_trouble\",\"initialTree\":[\"\",{\"children\":[\"(blog)\",{\"children\":[\"posts\",{\"children\":[[\"slug\",\"i18n_language_selector_trouble\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"i18n_language_selector_trouble\\\"}\",{}]}]}]}]},\"$undefined\",\"$undefined\",true],\"initialHead\":[false,\"$L5\"],\"globalErrorComponent\":\"$6\",\"children\":[null,[\"$\",\"html\",null,{\"lang\":\"ko\",\"children\":[[[\"$\",\"$L7\",null,{\"strategy\":\"afterInteractive\",\"src\":\"https://www.googletagmanager.com/gtag/js?id=undefined\"}],[\"$\",\"$L7\",null,{\"id\":\"gtag-init\",\"strategy\":\"afterInteractive\",\"dangerouslySetInnerHTML\":{\"__html\":\"\\n            window.dataLayer = window.dataLayer || [];\\n            function gtag(){dataLayer.push(arguments);}\\n            gtag('js', new Date());\\n            gtag('config', 'undefined', {\\n                page_path: window.location.pathname,\\n            });\\n          \"}}]],[\"$\",\"body\",null,{\"className\":\"__className_f8d089 px-[20px]\",\"children\":[[\"$\",\"div\",null,{\"id\":\"main-root\",\"className\":\"mx-[-20px]\",\"children\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$La\",\"notFoundStyles\":[],\"childProp\":{\"current\":[null,[[\"$\",\"header\",null,{\"className\":\"container-layout border-style flex justify-center border-y bg-zinc-800\",\"children\":[\"$\",\"div\",null,{\"className\":\"content-layout border-style flex items-center justify-between border-x\",\"children\":[[\"$\",\"$Lb\",null,{}],[\"$\",\"$Lc\",null,{}]]}]}],[\"$\",\"main\",null,{\"className\":\"flex min-h-screen flex-col\",\"children\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(blog)\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(blog)\",\"children\",\"posts\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"(blog)\",\"children\",\"posts\",\"children\",[\"slug\",\"i18n_language_selector_trouble\",\"d\"],\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$Ld\",\"notFoundStyles\":[],\"childProp\":{\"current\":[\"$Le\",\"$Lf\",null],\"segment\":\"__PAGE__?{\\\"slug\\\":\\\"i18n_language_selector_trouble\\\"}\"},\"styles\":[]}],\"segment\":[\"slug\",\"i18n_language_selector_trouble\",\"d\"]},\"styles\":[]}],\"segment\":\"posts\"},\"styles\":[]}]}],[\"$\",\"footer\",null,{\"className\":\"__className_bbf4d0 container-layout border-style border-y bg-neutral-800\",\"children\":[\"$\",\"div\",null,{\"className\":\"content-layout border-style border-x py-4\",\"children\":[\"$\",\"p\",null,{\"className\":\"text-center text-xs font-bold text-app-white md:text-sm\",\"children\":\"© 2023 Lani. All Rights Reserved.\"}]}]}]],null],\"segment\":\"(blog)\"},\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/cdb8f50a3d0f47d7.css\",\"precedence\":\"next\"}]]}]}],[\"$\",\"div\",null,{\"id\":\"modal-root\"}]]}]]}],null]}]]\n"])</script><script>self.__next_f.push([1,"10:I{\"id\":46685,\"chunks\":[\"685:static/chunks/685-4f0f72178562bcc6.js\",\"925:static/chunks/app/(blog)/posts/[slug]/not-found-6cce4e93524a058f.js\"],\"name\":\"\",\"async\":false}\n11:I{\"id\":63222,\"chunks\":[\"685:static/chunks/685-4f0f72178562bcc6.js\",\"716:static/chunks/716-6717d964125f0d18.js\",\"231:static/chunks/app/(blog)/posts/[slug]/page-0c21812a35fa1217.js\"],\"name\":\"Image\",\"async\":false}\n12:I{\"id\":33429,\"chunks\":[\"685:static/chunks/685-4f0f72178562bcc6.js\",\"716:static/chunks/716-6717d964125f0d18.js\",\"231:static/ch"])</script><script>self.__next_f.push([1,"unks/app/(blog)/posts/[slug]/page-0c21812a35fa1217.js\"],\"name\":\"\",\"async\":false}\n13:I{\"id\":23758,\"chunks\":[\"685:static/chunks/685-4f0f72178562bcc6.js\",\"716:static/chunks/716-6717d964125f0d18.js\",\"231:static/chunks/app/(blog)/posts/[slug]/page-0c21812a35fa1217.js\"],\"name\":\"\",\"async\":false}\n17:I{\"id\":6832,\"chunks\":[\"685:static/chunks/685-4f0f72178562bcc6.js\",\"716:static/chunks/716-6717d964125f0d18.js\",\"231:static/chunks/app/(blog)/posts/[slug]/page-0c21812a35fa1217.js\"],\"name\":\"\",\"async\":false}\n"])</script><script>self.__next_f.push([1,"a:[\"$\",\"div\",null,{\"className\":\"flex h-screen flex-col items-center justify-center bg-zinc-800 text-app-white\",\"children\":[[\"$\",\"img\",null,{\"src\":\"/assets/images/icons/not-found.svg\",\"alt\":\"page not found\",\"className\":\"h-[128px] w-[128px]\"}],[\"$\",\"p\",null,{\"className\":\"mt-8 text-2xl\",\"children\":\"페이지를 찾을 수 없어요\"}],[\"$\",\"$L10\",null,{\"href\":\"/\",\"className\":\"mt-2 flex items-center gap-2\",\"children\":[[\"$\",\"p\",null,{\"children\":\"홈으로\"}],[\"$\",\"img\",null,{\"src\":\"/assets/images/icons/right-arrow.svg\",\"alt\":\"move to home\",\"className\":\"h-[18px] w-[18px]\"}]]}]]}]\n"])</script><script>self.__next_f.push([1,"d:[\"$\",\"div\",null,{\"className\":\"container-layout bg-zinc-800\",\"children\":[\"$\",\"div\",null,{\"className\":\"content-layout bg-neutral-800 text-app-white\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center justify-center py-32\",\"children\":[[\"$\",\"img\",null,{\"src\":\"/assets/images/icons/not.svg\",\"className\":\"h-[80px] w-[80px]\",\"alt\":\"series is empty\"}],[\"$\",\"p\",null,{\"className\":\"mt-6\",\"children\":\"해당 포스트를 찾을 수 없어요\"}],[\"$\",\"$L10\",null,{\"href\":\"/posts\",\"className\":\"mt-2 flex items-center gap-2\",\"children\":[[\"$\",\"p\",null,{\"children\":\"다른 포스트 보러가기\"}],[\"$\",\"img\",null,{\"src\":\"/assets/images/icons/right-arrow.svg\",\"alt\":\"move to posts\",\"className\":\"h-[18px] w-[18px]\"}]]}]]}]}]}]\n"])</script><script>self.__next_f.push([1,"14:T536,"])</script><script>self.__next_f.push([1,"import { NextRequest, NextResponse } from 'next/server';\nimport acceptLanguage from 'accept-language';\nimport { fallbackLng, languages } from './i18n/settings';\n\nacceptLanguage.languages(languages);\n\nexport const config = {\n  matcher: [\n    '/((?!api|_next/static|_next/image|images|fonts|videos|assets|favicon.ico|robots|sitemap|sw.js).*)',\n  ],\n};\n\nconst cookieName = 'i18next';\n\nconst getLanguageFromRequest = (req: NextRequest): string | null =\u003e {\n  const language = req.cookies.has(cookieName)\n    ? req.cookies.get(cookieName)?.value // 1\n    : req.headers.get('Accept-Language'); // 2\n\n  return acceptLanguage.get(language) || null;\n};\n\nexport function middleware(req: NextRequest) {\n  const language = getLanguageFromRequest(req) || fallbackLng; // 3\n  const response = NextResponse.next();\n\n  response.cookies.set(cookieName, language); // 4\n\n  const languageInNextUrl = languages.find((loc) =\u003e\n    req.nextUrl.pathname.startsWith(`/${loc}`),\n  );\n\n  if (languageInNextUrl \u0026\u0026 language !== languageInNextUrl) {\n    response.cookies.set(cookieName, languageInNextUrl);\n  }\n\n  // 5\n  if (\n    !languages.some((loc) =\u003e req.nextUrl.pathname.startsWith(`/${loc}`)) \u0026\u0026\n    !req.nextUrl.pathname.startsWith('/_next')\n  ) {\n    return NextResponse.redirect(\n      new URL(`/${language}${req.nextUrl.pathname}`, req.url),\n    );\n  }\n}\n"])</script><script>self.__next_f.push([1,"15:T536,"])</script><script>self.__next_f.push([1,"import { NextRequest, NextResponse } from 'next/server';\nimport acceptLanguage from 'accept-language';\nimport { fallbackLng, languages } from './i18n/settings';\n\nacceptLanguage.languages(languages);\n\nexport const config = {\n  matcher: [\n    '/((?!api|_next/static|_next/image|images|fonts|videos|assets|favicon.ico|robots|sitemap|sw.js).*)',\n  ],\n};\n\nconst cookieName = 'i18next';\n\nconst getLanguageFromRequest = (req: NextRequest): string | null =\u003e {\n  const language = req.cookies.has(cookieName)\n    ? req.cookies.get(cookieName)?.value // 1\n    : req.headers.get('Accept-Language'); // 2\n\n  return acceptLanguage.get(language) || null;\n};\n\nexport function middleware(req: NextRequest) {\n  const language = getLanguageFromRequest(req) || fallbackLng; // 3\n  const response = NextResponse.next();\n\n  response.cookies.set(cookieName, language); // 4\n\n  const languageInNextUrl = languages.find((loc) =\u003e\n    req.nextUrl.pathname.startsWith(`/${loc}`),\n  );\n\n  if (languageInNextUrl \u0026\u0026 language !== languageInNextUrl) {\n    response.cookies.set(cookieName, languageInNextUrl);\n  }\n\n  // 5\n  if (\n    !languages.some((loc) =\u003e req.nextUrl.pathname.startsWith(`/${loc}`)) \u0026\u0026\n    !req.nextUrl.pathname.startsWith('/_next')\n  ) {\n    return NextResponse.redirect(\n      new URL(`/${language}${req.nextUrl.pathname}`, req.url),\n    );\n  }\n}\n"])</script><script>self.__next_f.push([1,"f:[[\"$\",\"section\",null,{\"className\":\"container-layout border-style grow-0 border-b bg-zinc-800\",\"children\":[\"$\",\"div\",null,{\"className\":\"content-layout border-style relative justify-center border-x text-center text-app-white\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-col justify-center px-4 py-16 md:px-5 md:py-20\",\"children\":[[\"$\",\"p\",null,{\"className\":\"mb-3 text-sm\",\"children\":[\"트러블슈팅\",\" \",\"$undefined\"]}],[\"$\",\"h1\",null,{\"className\":\"text-xl md:text-4xl\",\"children\":\"다국어 적용시 라우팅 관련 트러블슈팅\"}]]}]}]}],[\"$\",\"section\",null,{\"className\":\"container-layout border-style grow-0 border-b bg-zinc-800\",\"children\":[\"$\",\"div\",null,{\"className\":\"content-layout\",\"children\":[\"$\",\"div\",null,{\"className\":\"border-style align-center flex justify-center border-x text-app-white md:justify-start md:text-center\",\"children\":[[\"$\",\"p\",null,{\"className\":\"border-style border-l p-5 text-sm md:border-l-0\",\"children\":\"2023-09-07\"}],[\"$\",\"p\",null,{\"className\":\"border-style flex items-center justify-center gap-1 border-x p-5 text-sm\",\"children\":[[\"$\",\"$L11\",null,{\"src\":\"/assets/images/icons/timer.svg\",\"width\":21,\"height\":21,\"alt\":\"\"}],\"약 \",5,\"분\"]}]]}]}]}],[\"$\",\"section\",null,{\"className\":\"container-layout bg-zinc-800\",\"children\":[\"$\",\"div\",null,{\"className\":\"content-layout border-style flex flex-col border-x\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex\",\"children\":[[\"$\",\"$L12\",null,{\"toc\":[{\"level\":2,\"title\":\"언어 변경시 쿠키와 라우팅 경로가 불일치하는 현상 해결하기\",\"href\":\"#언어-변경시-쿠키와-라우팅-경로가-불일치하는-현상-해결하기\",\"children\":[{\"level\":3,\"title\":\"현재 미들웨어 구현 사항\",\"href\":\"#현재-미들웨어-구현-사항\"},{\"level\":3,\"title\":\"테스트 시나리오\",\"href\":\"#테스트-시나리오\"},{\"level\":3,\"title\":\"원인 파악\",\"href\":\"#원인-파악\"},{\"level\":3,\"title\":\"해결 방안\",\"href\":\"#해결-방안\"},{\"level\":3,\"title\":\"결론\",\"href\":\"#결론\"}]}],\"tags\":[\"i18n\",\"trouble shotting\"]}],[\"$\",\"div\",null,{\"className\":\"flex w-full flex-col bg-neutral-800 lg:w-[742px]\",\"children\":[[\"$\",\"div\",null,{\"className\":\"markdown-viewer box-border w-full bg-neutral-800 p-4 text-app-white md:p-5\",\"children\":[[\"$\",\"h2\",\"0\",{\"id\":\"언어-변경시-쿠키와-라우팅-경로가-불일치하는-현상-해결하기\",\"children\":[[\"$\",\"a\",\"0\",{\"aria-hidden\":\"true\",\"tabIndex\":-1,\"href\":\"#언어-변경시-쿠키와-라우팅-경로가-불일치하는-현상-해결하기\",\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"icon icon-link\"}]]}],\"언어 변경시 쿠키와 라우팅 경로가 불일치하는 현상 해결하기\"]}],\"\\n\",[\"$\",\"h3\",\"2\",{\"id\":\"현재-미들웨어-구현-사항\",\"children\":[[\"$\",\"a\",\"0\",{\"aria-hidden\":\"true\",\"tabIndex\":-1,\"href\":\"#현재-미들웨어-구현-사항\",\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"icon icon-link\"}]]}],\"현재 미들웨어 구현 사항\"]}],\"\\n\",[\"$\",\"div\",\"4\",{\"data-remark-code-title\":true,\"data-language\":\"ts\",\"children\":[\"middleware.ts\"]}],\"\\n\",[\"$\",\"pre\",\"6\",{\"children\":[[\"$\",\"$L13\",null,{\"node\":{\"type\":\"element\",\"tagName\":\"code\",\"properties\":{\"className\":[\"language-ts\"]},\"children\":[{\"type\":\"text\",\"value\":\"$14\"}],\"data\":{\"meta\":\"title=\\\"middleware.ts\\\"\"},\"position\":{\"start\":{\"line\":6,\"column\":1,\"offset\":57},\"end\":{\"line\":53,\"column\":4,\"offset\":1422}}},\"children\":[\"$15\"],\"language\":\"ts\"}]]}],\"\\n\",[\"$\",\"ol\",\"8\",{\"children\":[\"\\n\",[\"$\",\"li\",\"1\",{\"children\":[\"'/' 로 접근시 특정 쿠키 값이 존재하면 해당 값에 해당하는 라우팅 세그먼트로 변경\"]}],\"\\n\",[\"$\",\"li\",\"3\",{\"children\":[\"쿠키가 없다면 req.header accept-language로 설정된 값이 개발자가 설정한 언어 리스트에서 존재한다면 라우팅 세그먼트로 변경\"]}],\"\\n\",[\"$\",\"li\",\"5\",{\"children\":[\"모두 해당하지 않는다면 개발자가 설정한 fallback 언어로 라우팅 세그먼트로 변경\"]}],\"\\n\",[\"$\",\"li\",\"7\",{\"children\":[\"위 세가지에 절차를 마친 language 값을 쿠키에 저장\"]}],\"\\n\",[\"$\",\"li\",\"9\",{\"children\":[\"/{언어}가 아닌 다른 세그먼트 값으로 접근시 language 값을 첫번째 세그먼트에 세팅\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"10\",{\"children\":[\"위와 같은 middleware 설정시 개발자는 a 태그 또는 Link(next) 태그 그리고 router 사용시 pathname을 일관성있게 작업할 수 있게 된다.\"]}],\"\\n\",[\"$\",\"h3\",\"12\",{\"id\":\"테스트-시나리오\",\"children\":[[\"$\",\"a\",\"0\",{\"aria-hidden\":\"true\",\"tabIndex\":-1,\"href\":\"#테스트-시나리오\",\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"icon icon-link\"}]]}],\"테스트 시나리오\"]}],\"\\n\",[\"$\",\"ol\",\"14\",{\"children\":[\"\\n\",[\"$\",\"li\",\"1\",{\"children\":[\"'/' 경로로 접근 \u003e fallback 언어 redirect 정상 작동 \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":[\"(예: '/' -\u003e '/en')\"]}]]}],\"\\n\",[\"$\",\"li\",\"3\",{\"children\":[\"루트 경로('/en') \u003e 언어변경 정상 작동 \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":[\"(예: '/en' -\u003e '/th')\"]}]]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"16\",{\"children\":[[\"$\",\"img\",null,{\"src\":\"data:image/i18n_language_selector_trouble;base64,dmVyc2lvbiBodHRwczovL2dpdC1sZnMuZ2l0aHViLmNvbS9zcGVjL3YxCm9pZCBzaGEyNTY6NmVjMzMyMWU0MDQ3NGFmNWVlNzhlMWY4YzRmNDExMmZhN2I0MGQzMzZhMmVmNWQ2MWQyZjU5YWQyZjhiMTQwOApzaXplIDE1NzM5NzAwCg==\",\"alt\":\"i18n_language_selector_trouble\",\"className\":\"max-w-full\"}]]}],\"\\n\",[\"$\",\"ol\",\"18\",{\"start\":3,\"children\":[\"\\n\",[\"$\",\"li\",\"1\",{\"children\":[\"루트 경로 \u003e about 페이지 이동 정상 작동 \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":[\"(예: '/th' \u003e '/th/about')\"]}]]}],\"\\n\",[\"$\",\"li\",\"3\",{\"children\":[\"about 페이지 \u003e 언어 변경 \u003e 변경된 언어의 루트 이동 정상 작동 \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":[\"(예: /{변경 언어})\"]}]]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"20\",{\"children\":[[\"$\",\"img\",null,{\"src\":\"data:image/i18n_language_selector_trouble_2;base64,dmVyc2lvbiBodHRwczovL2dpdC1sZnMuZ2l0aHViLmNvbS9zcGVjL3YxCm9pZCBzaGEyNTY6YmUyODQ0MWQ0YmE2MDgwMDU2NjZlMmRjZWE2YWNmMzg0ZDZhMzQwYTc4ZmNiZmVjZmVlNzYzZDE5N2M0MWY5YgpzaXplIDE3MDk5Mzk3Cg==\",\"alt\":\"i18n_language_selector_trouble_2\",\"className\":\"max-w-full\"}]]}],\"\\n\",[\"$\",\"ol\",\"22\",{\"start\":5,\"children\":[\"\\n\",[\"$\",\"li\",\"1\",{\"children\":[\"루트 \u003e about 페이지 이동 \",[\"$\",\"em\",\"1\",{\"children\":[[\"$\",\"strong\",\"0\",{\"children\":[\"쿠키는 정상 작동, routing 오작동\"]}]]}]]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"24\",{\"children\":[[\"$\",\"img\",null,{\"src\":\"data:image/i18n_language_selector_trouble_3;base64,dmVyc2lvbiBodHRwczovL2dpdC1sZnMuZ2l0aHViLmNvbS9zcGVjL3YxCm9pZCBzaGEyNTY6MTE1MThjODM1MzkzMDgyZmVhMjQyZDUzMjRjZWM2MDgwODMyNTc5MDk5NzZiYzQwZmQzZTBmOWM1ZDI0YmUzOQpzaXplIDExNzg4MzE0Cg==\",\"alt\":\"i18n_language_selector_trouble_3\",\"className\":\"max-w-full\"}]]}],\"\\n\",[\"$\",\"h3\",\"26\",{\"id\":\"원인-파악\",\"children\":[[\"$\",\"a\",\"0\",{\"aria-hidden\":\"true\",\"tabIndex\":-1,\"href\":\"#원인-파악\",\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"icon icon-link\"}]]}],\"원인 파악\"]}],\"\\n\",[\"$\",\"p\",\"28\",{\"children\":[\"원인은 다름 아닌 NextJS 캐싱이 원인이였다.\"]}],\"\\n\",[\"$\",\"p\",\"30\",{\"children\":[\"현재 동작에서는 언어 설정 변경시 next/navigation의 \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":[\"router.push\"]}],\"를 통해 라우팅을 변경해줬다.\"]}],\"\\n\",[\"$\",\"p\",\"32\",{\"children\":[\"next의 앱 라우터는 라우팅 탐색에 대해 하이브리드 접근 방식을 사용하고 있다.\"]}],\"\\n\",[\"$\",\"ul\",\"34\",{\"children\":[\"\\n\",[\"$\",\"li\",\"1\",{\"children\":[\"서버 - 라우트 세그먼트별로 자동으로 애플리케이션 코드가 분할된다.\"]}],\"\\n\",[\"$\",\"li\",\"3\",{\"children\":[\"클라이언트 - Next.js는 라우트 세그먼트를 미리 가져오고 캐시한다.\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"36\",{\"children\":[\"이렇게 하는 이유는 사용자가 새 경로로 이동할 때 브라우저가 페이지를 다시 로드하지 않고 변경된 경로 세그먼트만 다시 렌더링하여 사용자 경험과 성능을 개선하기 위해서라고 한다.\\n\",[\"$\",\"a\",\"1\",{\"href\":\"https://nextjs.org/docs/app/building-your-application/routing/linking-and-navigating#how-routing-and-navigation-works\",\"children\":[\"참고\"]}]]}],\"\\n\",[\"$\",\"h3\",\"38\",{\"id\":\"해결-방안\",\"children\":[[\"$\",\"a\",\"0\",{\"aria-hidden\":\"true\",\"tabIndex\":-1,\"href\":\"#해결-방안\",\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"icon icon-link\"}]]}],\"해결 방안\"]}],\"\\n\",[\"$\",\"p\",\"40\",{\"children\":[\"언어 변경시 루트 경로로 라우팅 처리를 해주고 있다.\"]}],\"\\n\",[\"$\",\"p\",\"42\",{\"children\":[\"현재 라우팅 세그먼트를 유지할 필요가 없다면, \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":[\"window.location.href\"]}],\"를 변경해서 브라우저 주소 값을 변경해서 페이지를 처음부터 다시 로드해도 될 것 같다.\"]}],\"\\n\",[\"$\",\"p\",\"44\",{\"children\":[\"개발자도구 \u003e 네트워크 탭을 통해 원인이 맞는지 확인해보자.\"]}],\"\\n\",[\"$\",\"ul\",\"46\",{\"children\":[\"\\n\",[\"$\",\"li\",\"1\",{\"children\":[[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":[\"router.push\"]}],\"를 통해 라우팅 했을 때\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"48\",{\"children\":[[\"$\",\"img\",null,{\"src\":\"data:image/i18n_language_selector_trouble_4;base64,dmVyc2lvbiBodHRwczovL2dpdC1sZnMuZ2l0aHViLmNvbS9zcGVjL3YxCm9pZCBzaGEyNTY6OTRlZmQ5NjQ0Zjg0M2U4YjY4NzgxZDJkMzk1Yzc4ODBlMDQ0ZDc2ZDkxY2UzOGI1ZmYxN2FjZjkwNzVhYzIyMQpzaXplIDUwMjEwNjgwCg==\",\"alt\":\"i18n_language_selector_trouble_4\",\"className\":\"max-w-full\"}]]}],\"\\n\",[\"$\",\"ul\",\"50\",{\"children\":[\"\\n\",[\"$\",\"li\",\"1\",{\"children\":[[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":[\"window.location.href\"]}],\"를 통해 라우팅 했을 때\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"52\",{\"children\":[[\"$\",\"img\",null,{\"src\":\"data:image/i18n_language_selector_trouble_5;base64,dmVyc2lvbiBodHRwczovL2dpdC1sZnMuZ2l0aHViLmNvbS9zcGVjL3YxCm9pZCBzaGEyNTY6NmM1NGYyZDMyOThiNTQ2ODllNTRlZGI0Y2MyNGIxMTc2MWFkYzY2ODhlNTI3NDExMzgxMmYwOGVlNWVhZGFlMgpzaXplIDU1MTkyMjAzCg==\",\"alt\":\"i18n_language_selector_trouble_5\",\"className\":\"max-w-full\"}]]}],\"\\n\",[\"$\",\"h3\",\"54\",{\"id\":\"결론\",\"children\":[[\"$\",\"a\",\"0\",{\"aria-hidden\":\"true\",\"tabIndex\":-1,\"href\":\"#결론\",\"children\":[[\"$\",\"span\",\"0\",{\"className\":\"icon icon-link\"}]]}],\"결론\"]}],\"\\n\",[\"$\",\"p\",\"56\",{\"children\":[\"쿠키, routing 모두 동일하게 정상 작동한다.\"]}],\"\\n\",[\"$\",\"p\",\"58\",{\"children\":[\"하지만 \",[\"$\",\"code\",null,{\"className\":\"$undefined\",\"children\":[\"window.location.href\"]}],\"로 처리하는게 정답인지는 모르겠다.\"]}],\"\\n\",[\"$\",\"p\",\"60\",{\"children\":[\"만약 언어별 다른 도메인을 사용했다면 당연히 처리해야했지만 i18n 연동을 하여 동일한 도메인에 세그먼트만 동적으로 처리하다 보니 router.push로 당연히 될 줄 알았다.\"]}],\"\\n\",[\"$\",\"p\",\"62\",{\"children\":[\"언어 변경시에만 캐싱 처리를 회피하면서 next app router를 활용할 방안을 고민해야하는 숙제가 생겼다.\"]}]]}],\"$L16\",[\"$\",\"div\",null,{\"className\":\"flex-between border-style mt-auto flex border-t bg-zinc-800 text-app-white\",\"children\":[[\"$\",\"div\",null,{\"className\":\"border-style flex w-[50%] p-4\",\"children\":[\"$\",\"$L10\",null,{\"href\":\"/posts/remove_git_file_history\",\"className\":\"flex gap-4\",\"children\":[[\"$\",\"span\",null,{\"children\":[\"$\",\"img\",null,{\"src\":\"/assets/images/icons/left-arrow.svg\",\"alt\":\"prev\",\"className\":\"h-[18px] w-[18px]\"}]}],[\"$\",\"div\",null,{\"className\":\"flex flex-col items-start gap-1\",\"children\":[[\"$\",\"p\",null,{\"className\":\"text-sm text-neutral-500\",\"children\":\"prev\"}],[\"$\",\"p\",null,{\"className\":\"max-w-[120px] truncate text-neutral-300 md:max-w-[200px]\",\"children\":[\"Github에 잘못 올린 파일 및 커밋 히스토리 삭제하기\",\"Github에 잘못 올린 파일 및 커밋 히스토리 삭제하기\",\"Github에 잘못 올린 파일 및 커밋 히스토리 삭제하기\"]}]]}]]}]}],[\"$\",\"div\",null,{\"className\":\"flex w-[50%] justify-end p-4\",\"children\":null}]]}],[\"$\",\"$L17\",null,{}]]}]]}]}]}]]\n"])</script><script>self.__next_f.push([1,"5:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"라니.로그 | 다국어 적용시 라우팅 관련 트러블슈팅\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"i18n 작업 중 언어 변경시에 캐시로 인한 라우팅 오작동 문제 해결하기\"}],[\"$\",\"meta\",\"3\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"link\",\"4\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"200x200\"}]]\ne:null\n"])</script><script>self.__next_f.push([1,"16:[\"$\",\"div\",null,{\"className\":\"border-style mt-auto flex flex-col border-t p-4 text-app-white\",\"children\":[[\"$\",\"p\",null,{\"className\":\"text-base text-app-blue-green\",\"children\":[\"$\",\"span\",null,{\"className\":\"border-style inline-block border-x border-t bg-zinc-800 px-4 py-2\",\"children\":[\"See more \\\"\",\"트러블슈팅\",\"\\\"\"]}]}],[\"$\",\"ul\",null,{\"className\":\"border-style border bg-zinc-800\",\"children\":[[\"$\",\"li\",\"다국어 적용시 라우팅 관련 트러블슈팅\",{\"className\":\"border-style flex gap-4 border-b p-4 text-sm last-of-type:border-b-0\",\"children\":[[\"$\",\"p\",null,{\"children\":1}],[\"$\",\"$L10\",null,{\"href\":\"/posts/i18n_language_selector_trouble\",\"children\":\"다국어 적용시 라우팅 관련 트러블슈팅\"}],[\"$\",\"p\",null,{\"className\":\"ml-auto\",\"children\":\"2023.09.07\"}]]}]]}]]}]\n"])</script></body></html>